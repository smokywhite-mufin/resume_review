openapi: "3.0.0"
info:
  version: 0.4.0
  title: Resume Analysis API
  description: 이력서 분석 및 면접 질문 생성 API
  license:
    name: ryeong
servers:
  - url: http://localhost:8000

paths:
  /api/resume/upload:
    post:
      tags:
        - Resume
      summary: 이력서 업로드
      description: PDF 이력서 파일을 업로드하고 지원자 정보를 추출합니다
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: PDF 이력서 파일
              required:
                - file
      responses:
        "200":
          description: 업로드 성공
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UploadResponse"
              example:
                message: "File uploaded successfully"
                name: "홍길동"
                resume_id: 1
                applicant_id: 1
                created_at: "2024-12-11T10:30:00.000Z"
        "400":
          description: 파일 없음
          content:
            application/json:
              example:
                error: "No file uploaded"
        "500":
          description: 서버 에러
          content:
            application/json:
              example:
                error: "Error message"

  /api/resumes:
    get:
      tags:
        - Resume
      summary: 이력서 목록 조회
      description: 모든 이력서 목록을 최신순으로 조회합니다
      responses:
        "200":
          description: 이력서 목록
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Resume"
              example:
                - resume_id: 1
                  applicant_id: 1
                  file_path: "uploads/1702345678901.pdf"
                  analyze_result: '{"이름":"홍길동","생년월일":"1995.01.15","연락처":"010-1234-5678","이메일":"hong@example.com","Github 주소":"https://github.com/honggildong","강점":["문제 해결 능력이 뛰어남","새로운 기술 학습에 적극적"],"기술스택":["JavaScript","React","Node.js"],"총점":85}'
                  question_list: '{"질문":["JavaScript의 이벤트 루프에 대해 설명해주세요.","React의 생명주기에 대해 설명해주세요."]}'
                  created_at: "2024-12-11T10:30:00.000Z"
                  updated_at: "2024-12-11T10:35:00.000Z"
                - resume_id: 2
                  applicant_id: 2
                  file_path: "uploads/1702345678902.pdf"
                  analyze_result: '{"이름":"김철수","생년월일":"1998.05.20","연락처":"010-9876-5432","이메일":"kim@example.com","Github 주소":null,"강점":["꼼꼼한 코드 리뷰","팀 협업 능력 우수"],"기술스택":["TypeScript","Next.js","Express"],"총점":78}'
                  question_list: '{"질문":["TypeScript의 장점에 대해 설명해주세요.","Next.js의 SSR과 SSG 차이점은 무엇인가요?"]}'
                  created_at: "2024-12-11T11:00:00.000Z"
                  updated_at: "2024-12-11T11:00:00.000Z"
        "500":
          description: 서버 에러
          content:
            application/json:
              example:
                error: "Error message"

  /api/resumes/{resumeId}/analyze:
    post:
      tags:
        - Resume
      summary: 이력서 분석
      description: AI를 사용하여 이력서를 분석하고 면접 질문을 생성합니다
      parameters:
        - name: resumeId
          in: path
          required: true
          description: 분석할 이력서 ID
          schema:
            type: integer
          example: 1
      responses:
        "200":
          description: 분석 성공
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AnalyzeResponse"
              example:
                message: "Resume analyzed successfully"
                data:
                  analyzeResultJson:
                    이름: "홍길동"
                    생년월일: "1995.01.15"
                    연락처: "010-1234-5678"
                    이메일: "hong@example.com"
                    Github 주소: "https://github.com/honggildong"
                    강점:
                      - "문제 해결 능력이 뛰어나며 복잡한 이슈도 체계적으로 접근합니다."
                      - "새로운 기술 학습에 적극적이고 빠르게 적응합니다."
                      - "팀원들과의 원활한 소통으로 협업 효율을 높입니다."
                    기술스택:
                      - "JavaScript"
                      - "TypeScript"
                      - "React"
                      - "Node.js"
                      - "Express"
                      - "HTML"
                      - "CSS"
                      - "Git"
                    총점: 85
                  questionListJson:
                    질문:
                      - "JavaScript의 var, let, const 차이점에 대해 설명해주세요."
                      - "Node.js의 이벤트 루프에 대해 설명해주세요."
                      - "HTML의 시맨틱 태그란 무엇인가요?"
                      - "HTTP 요청 메서드의 종류와 용도에 대해 설명해주세요."
                      - "웹 브라우저가 URL을 입력받고 화면을 렌더링하는 과정을 설명해주세요."
                  updated_at: "2024-12-11T10:35:00.000Z"
        "500":
          description: 서버 에러
          content:
            application/json:
              example:
                error: "Error message"

components:
  schemas:
    Resume:
      type: object
      properties:
        resume_id:
          type: integer
          description: 이력서 ID
        applicant_id:
          type: integer
          description: 지원자 ID
        file_path:
          type: string
          description: 파일 경로
        analyze_result:
          type: string
          nullable: true
          description: 분석 결과 (JSON 문자열)
        question_list:
          type: string
          nullable: true
          description: 면접 질문 목록 (JSON 문자열)
        created_at:
          type: string
          format: date-time
          description: 생성일시
        updated_at:
          type: string
          format: date-time
          description: 수정일시

    UploadResponse:
      type: object
      properties:
        message:
          type: string
          description: 결과 메시지
        name:
          type: string
          description: 추출된 지원자 이름
        resume_id:
          type: integer
          description: 생성된 이력서 ID
        applicant_id:
          type: integer
          description: 생성된 지원자 ID
        created_at:
          type: string
          format: date-time
          description: 생성일시

    AnalyzeResponse:
      type: object
      properties:
        message:
          type: string
          description: 결과 메시지
        data:
          type: object
          properties:
            analyzeResultJson:
              type: object
              properties:
                이름:
                  type: string
                  nullable: true
                  description: 지원자 이름
                생년월일:
                  type: string
                  nullable: true
                  description: 생년월일
                연락처:
                  type: string
                  nullable: true
                  description: 연락처
                이메일:
                  type: string
                  nullable: true
                  description: 이메일 주소
                Github 주소:
                  type: string
                  nullable: true
                  description: Github 프로필 URL
                강점:
                  type: array
                  items:
                    type: string
                  description: 지원자 강점 목록
                기술스택:
                  type: array
                  items:
                    type: string
                  description: 기술 스택 목록
                총점:
                  type: integer
                  minimum: 0
                  maximum: 100
                  description: 총점 (0~100)
            questionListJson:
              type: object
              properties:
                질문:
                  type: array
                  items:
                    type: string
                  description: 면접 질문 목록 (30개)
            updated_at:
              type: string
              format: date-time
              description: 분석 완료 일시

    Error:
      type: object
      properties:
        error:
          type: string
          description: 에러 메시지
